"""
ğŸ¤— Hugging Face Inference API - å¿«é€Ÿå‚è€ƒå¡ç‰‡
============================================

ğŸ“Œ ç¬¬ä¸€æ­¥:å®‰è£…
--------------
!pip install huggingface_hub


ğŸ“Œ ç¬¬äºŒæ­¥:è·å– Token
--------------------
1. è®¿é—®: https://huggingface.co/settings/tokens
2. åˆ›å»º Read token
3. åœ¨ Colab å·¦ä¾§ ğŸ”‘ æ·»åŠ  Secret:
   - Name: HuggingFace
   - Value: ä½ çš„ token


ğŸ“Œ ç¬¬ä¸‰æ­¥:åŸºç¡€è®¾ç½®
------------------
from huggingface_hub import InferenceClient
from google.colab import userdata

hf_token = userdata.get('HuggingFace')
client = InferenceClient(token=hf_token)


ğŸ“Œ å¸¸ç”¨ä»£ç ç‰‡æ®µ
--------------

1ï¸âƒ£ ç®€å•å¯¹è¯
------------
messages = [
    {"role": "system", "content": "ä½ æ˜¯å‹å–„çš„åŠ©æ‰‹,ç”¨ç¹ä½“ä¸­æ–‡å›ç­”"},
    {"role": "user", "content": "ä½ å¥½"}
]

response = client.chat_completion(
    messages=messages,
    model="Qwen/Qwen2.5-7B-Instruct",
    max_tokens=200
)

print(response.choices[0].message.content)


2ï¸âƒ£ Lucky Vicky ç”Ÿæˆå™¨
----------------------
def lucky_post_hf(event):
    system = '''è«‹ç”¨å°ç£ç¿’æ…£çš„ä¸­æ–‡ä¾†å¯«é€™æ®µ po æ–‡:
è«‹ç”¨å“¡ç‘›å¼æ€è€ƒ, ä¹Ÿå°±æ˜¯ä»€éº¼éƒ½æ­£å‘æ€ç¶­ä»»ä½•ä½¿ç”¨è€…å¯«çš„äº‹æƒ…,
ç”¨æˆ‘çš„ç¬¬ä¸€äººç¨±ã€ç¤¾ç¾¤åª’é«” po æ–‡çš„å£å»èªªä¸€æ¬¡,
èªªç‚ºä»€éº¼é€™æ˜¯ä¸€ä»¶è¶…å¹¸é‹çš„äº‹, ä¸¦ä¸”ä»¥ã€Œå®Œå…¨æ˜¯ Lucky Vicky å‘€!ã€çµå°¾ã€‚
å¯ä»¥é©åº¦çš„åŠ ä¸Š emojiã€‚'''
    
    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": event}
    ]
    
    response = client.chat_completion(
        messages=messages,
        model="Qwen/Qwen2.5-7B-Instruct",
        max_tokens=500,
        temperature=0.8
    )
    
    return response.choices[0].message.content

# ä½¿ç”¨
result = lucky_post_hf("ä»Šå¤©å’–å•¡ç‘äº†")
print(result)


3ï¸âƒ£ æ–‡æœ¬ç”Ÿæˆ
------------
response = client.text_generation(
    prompt="å°ç£æœ€æœ‰åçš„å°åƒæ˜¯",
    model="Qwen/Qwen2.5-1.5B-Instruct",
    max_new_tokens=100
)
print(response)


4ï¸âƒ£ ç¿»è¯‘
--------
def translate(text, target="ç¹é«”ä¸­æ–‡"):
    messages = [
        {"role": "system", "content": f"ç¿»è¯‘æˆ{target}"},
        {"role": "user", "content": text}
    ]
    response = client.chat_completion(
        messages=messages,
        model="Qwen/Qwen2.5-7B-Instruct",
        max_tokens=200
    )
    return response.choices[0].message.content

print(translate("Hello world"))


5ï¸âƒ£ æƒ…æ„Ÿåˆ†æ
------------
def sentiment(text):
    messages = [
        {"role": "system", "content": "åˆ†ææƒ…æ„Ÿ,åªå›ç­”:æ­£é¢/è´Ÿé¢/ä¸­æ€§"},
        {"role": "user", "content": f"åˆ†æ: {text}"}
    ]
    response = client.chat_completion(
        messages=messages,
        model="Qwen/Qwen2.5-1.5B-Instruct",
        max_tokens=20
    )
    return response.choices[0].message.content

print(sentiment("é€™å€‹ç”¢å“å¤ªæ£’äº†!"))


6ï¸âƒ£ æµå¼è¾“å‡º
------------
messages = [{"role": "user", "content": "è¬›å€‹æ•…äº‹"}]

for token in client.chat_completion(
    messages=messages,
    model="Qwen/Qwen2.5-1.5B-Instruct",
    max_tokens=200,
    stream=True
):
    print(token.choices[0].delta.content, end="", flush=True)


ğŸ“Œ æ¨èæ¨¡å‹
-----------
| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | ä¸­æ–‡èƒ½åŠ› | ç”¨é€” |
|------|------|------|----------|------|
| Qwen/Qwen2.5-1.5B-Instruct | å° | å¿« | â­â­â­ | æµ‹è¯•ã€ç®€å•ä»»åŠ¡ |
| Qwen/Qwen2.5-7B-Instruct | ä¸­ | ä¸­ | â­â­â­â­â­ | Lucky Vickyã€ç¿»è¯‘ |
| Qwen/Qwen2.5-72B-Instruct | å¤§ | æ…¢ | â­â­â­â­â­ | å¤æ‚ä»»åŠ¡ |
| meta-llama/Llama-3.1-8B-Instruct | ä¸­ | ä¸­ | â­â­â­â­ | é€šç”¨å¯¹è¯ |


ğŸ“Œ é‡è¦å‚æ•°
-----------
max_tokens: ç”Ÿæˆçš„æœ€å¤§ token æ•°
  - çŸ­å›å¤: 50-100
  - ä¸­ç­‰: 200-300
  - é•¿æ–‡: 500-1000

temperature: åˆ›æ„ç¨‹åº¦
  - 0.1-0.3: ç¡®å®šã€ä¸€è‡´
  - 0.7-0.9: æœ‰åˆ›æ„ (æ¨è)
  - 1.0+: éå¸¸éšæœº

top_p: é‡‡æ ·èŒƒå›´
  - 0.9: å¹³è¡¡ (é»˜è®¤)
  - 0.95: æ›´å¤šæ ·


ğŸ“Œ é”™è¯¯å¤„ç†
-----------
try:
    response = client.chat_completion(...)
except Exception as e:
    print(f"é”™è¯¯: {e}")
    # å¯ä»¥åˆ‡æ¢å¤‡ç”¨æ¨¡å‹


ğŸ“Œ ä¸ Gradio é›†æˆ
-----------------
import gradio as gr

def process(text, provider):
    if provider == "Hugging Face":
        messages = [{"role": "user", "content": text}]
        response = client.chat_completion(
            messages=messages,
            model="Qwen/Qwen2.5-7B-Instruct",
            max_tokens=300
        )
        return response.choices[0].message.content
    # ... å…¶ä»–æä¾›å•†

with gr.Blocks() as demo:
    input_text = gr.Textbox(label="è¾“å…¥")
    provider = gr.Dropdown(["Hugging Face", "Groq"], label="æ¨¡å‹")
    output = gr.Textbox(label="è¾“å‡º")
    btn = gr.Button("æäº¤")
    btn.click(process, [input_text, provider], output)

demo.launch(share=True)


ğŸ“Œ å¸¸è§é—®é¢˜
-----------
Q: éœ€è¦ä»˜è´¹å—?
A: å…è´¹ä½¿ç”¨,ä½†æœ‰é€Ÿç‡é™åˆ¶ã€‚ä»˜è´¹å¯è·å¾—æ›´é«˜é™åˆ¶ã€‚

Q: å¯ä»¥ç¦»çº¿ä½¿ç”¨å—?
A: Inference API éœ€è¦ç½‘ç»œã€‚ç¦»çº¿è¯·ç”¨ transformers ä¸‹è½½æ¨¡å‹ã€‚

Q: æ”¯æŒå“ªäº›è¯­è¨€?
A: Qwen æ¨¡å‹å¯¹ä¸­æ–‡æ”¯æŒæœ€å¥½,Llama æ”¯æŒå¤šè¯­è¨€ã€‚

Q: å¦‚ä½•æé«˜é€Ÿåº¦?
A: ä½¿ç”¨å°æ¨¡å‹ (1.5B),å‡å°‘ max_tokens,æˆ–ä½¿ç”¨ Groqã€‚


ğŸ“Œ å®Œæ•´ç¤ºä¾‹:å¤šæä¾›å•† Lucky Vicky
---------------------------------
def lucky_vicky(event, provider="hf"):
    system = "å“¡ç‘›å¼æ€è€ƒæç¤ºè¯..."
    
    if provider == "hf":
        messages = [
            {"role": "system", "content": system},
            {"role": "user", "content": event}
        ]
        response = client.chat_completion(
            messages=messages,
            model="Qwen/Qwen2.5-7B-Instruct",
            max_tokens=500,
            temperature=0.8
        )
        return response.choices[0].message.content
    
    elif provider == "groq":
        return reply(system=system, prompt=event, 
                    provider="groq", model="openai/gpt-oss-120b")

# ä½¿ç”¨
print(lucky_vicky("ä»Šå¤©é²åˆ°äº†", "hf"))


ğŸ“Œ èµ„æºé“¾æ¥
-----------
- Hugging Face Hub: https://huggingface.co/
- è·å– Token: https://huggingface.co/settings/tokens
- æ¨¡å‹åº“: https://huggingface.co/models
- API æ–‡æ¡£: https://huggingface.co/docs/huggingface_hub
- Qwen æ¨¡å‹: https://huggingface.co/Qwen


ğŸ“Œ ä¸‹ä¸€æ­¥
---------
1. âœ… è·å– API Token
2. âœ… åœ¨ Colab æ·»åŠ  Secret
3. âœ… è¿è¡ŒåŸºç¡€æµ‹è¯•
4. âœ… é›†æˆåˆ° Lucky Vicky
5. âœ… åˆ›å»º Gradio App
6. ğŸš€ éƒ¨ç½²åˆ° Hugging Face Spaces (å¯é€‰)


============================================
ç¥æ‚¨ä½¿ç”¨æ„‰å¿«! ğŸ‰
æœ‰é—®é¢˜éšæ—¶é—®æˆ‘!
============================================
"""
